<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>í™˜ì ìƒì„¸ ì •ë³´</title>
    <style>
        .container { max-width: 800px; margin: 30px auto; padding: 20px; border: 1px solid #ddd; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; margin-bottom: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f8f9fa; }

        .btn-action { padding: 5px 10px; text-decoration: none; border-radius: 4px; color: white; font-size: 14px; }
        .btn-create { background-color: #007bff; } /* íŒŒë€ìƒ‰: ì‘ì„± */
        .btn-view { background-color: #6c757d; }   /* íšŒìƒ‰: ì¡°íšŒ */
        .btn-edit { background-color: #ffc107; color: black; } /* ë…¸ë€ìƒ‰: ìˆ˜ì • */
    </style>
</head>
<body>

<div th:replace="layout/header :: headerFragment"></div>

<main class="container">
    <h1>í™˜ì ìƒì„¸ ì •ë³´</h1>

    <div style="background: #f1f1f1; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
        <li>ì°¨íŠ¸ë²ˆí˜¸: <span th:text="${patient.patient_num}"></span></li>
        <li>ì´ë¦„: <strong th:text="${patient.name}"></strong></li>
        <li>ì—°ë½ì²˜: <span th:text="${patient.phone}"></span></li>
        <li>ìƒë…„ì›”ì¼: <span th:text="${#temporals.format(patient.birth_date, 'yyyy-MM-dd')}"></span></li>
        <li>ì„±ë³„: <span th:text="${patient.gender.description}"></span></li>
        <li>ê°€ì…ì¼: <span th:text="${#temporals.format(patient.created_at, 'yyyy-MM-dd HH:mm')}"></span></li>
    </div>

    <hr>

    <h3>ì˜ˆì•½ ë‚´ì—­ (ì§„ë£Œ ëŒ€ê¸°)</h3>
    <table border="1">
        <thead>
        <tr>
            <th>ì˜ˆì•½ì¼ì‹œ</th>
            <th>ë‹´ë‹¹ì˜</th>
            <th>ìƒíƒœ</th>
            <th>ê´€ë¦¬ (ì§„ë£Œ ì‹œì‘)</th>
        </tr>
        </thead>
        <tbody>
        <tr th:if="${#lists.isEmpty(reservations)}">
            <td colspan="4">ì˜ˆì•½ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
        </tr>
        <tr th:each="res : ${reservations}">
            <td th:text="${#temporals.format(res.reservationDate, 'yyyy-MM-dd HH:mm')}"></td>
            <td th:text="${res.doctorName}"></td>
            <td><span th:text="${res.statusDescription}"></span></td>
            <td>
                <!--ì§„ë£Œ ëŒ€ê¸° ìƒíƒœì¼ ê²½ìš°ì—ë§Œ í‘œì‹œ-->
                <a th:if="${res.status == 1}"
                   th:href="@{/records/new(reservationNum=${res.reservationNum})}"
                   class="btn-action btn-create">
                    ğŸ©º ì§„ë£Œ ì°¨íŠ¸ ì‘ì„±
                </a>

                <span th:if="${res.status == 3}" style="color: green; font-weight: bold;">ì§„ë£Œ ì™„ë£Œ</span>
                <span th:if="${res.status == 0}" style="color: orange;">ìŠ¹ì¸ ëŒ€ê¸°</span>
                <span th:if="${res.status == 2}" style="color: gray;">ì·¨ì†Œë¨</span>
            </td>
        </tr>
        </tbody>
    </table>

    <hr>

    <h3>ê³¼ê±° ì§„ë£Œ ì´ë ¥</h3>
    <table border="1">
        <thead>
        <tr>
            <th>ì§„ë£Œì¼</th>
            <th>ì§„ë‹¨ëª…</th>
            <th>ë‹´ë‹¹ì˜</th>
            <th>ìƒì„¸ë³´ê¸°</th>
        </tr>
        </thead>
        <tbody>
        <tr th:if="${#lists.isEmpty(historyList)}">
            <td colspan="4">ê³¼ê±° ì§„ë£Œ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</td>
        </tr>
        <tr th:each="hist : ${historyList}">
            <td th:text="${#temporals.format(hist.treatmentDate, 'yyyy-MM-dd')}"></td>
            <td th:text="${hist.diagnosis}"></td>
            <td th:text="${hist.doctorName}"></td>
            <td>
                <a th:href="@{/records/{id}(id=${hist.treatmentNum})}" class="btn-action btn-view">
                    ìƒì„¸ ë³´ê¸°
                </a>
            </td>
        </tr>
        </tbody>
    </table>

    <br>
    <a href="/patients">í™˜ì ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
</main>

<div th:replace="layout/footer :: footerFragment"></div>

</body>
</html>