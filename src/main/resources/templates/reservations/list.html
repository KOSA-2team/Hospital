<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>예약 목록</title>
    <link rel="stylesheet" th:href="@{/css/global.css}" />
</head>

<body>

    <div th:replace="layout/header :: headerFragment"></div>

    <main class="main-layout">
        <div class="page-header">
            <div>
                <h1 class="page-title">예약 현황판</h1>
                <p class="page-subtitle">진료 예약 목록 및 관리</p>
            </div>
            <a href="/reservations/new" class="btn btn-primary">
                새 예약 등록
            </a>
        </div>

        <div class="card">
            <div class="table-wrapper">
                <table class="table">
                    <thead>
                        <tr>
                            <th>번호</th>
                            <th>예약 일시</th>
                            <th>환자명</th>
                            <th>담당 의사</th>
                            <th>상태</th>
                            <th>관리</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:if="${#lists.isEmpty(reservations)}">
                            <td colspan="6" style="text-align: center; padding: 20px; color: var(--text-muted);">
                                등록된 예약이 없습니다.
                            </td>
                        </tr>

                        <tr th:each="appt : ${reservations}">
                            <td>
                                <a th:href="@{/reservations/{id}(id=${appt.reservationNum})}"
                                    th:text="${appt.reservationNum}" class="text-primary font-bold">1</a>
                            </td>
                            <td th:text="${#temporals.format(appt.reservationDate, 'yyyy-MM-dd HH:mm')}">2023-12-05
                                14:00</td>
                            <td>
                                <a th:href="@{/reservations/{id}(id=${appt.reservationNum})}"
                                    th:text="${appt.patientName}" class="text-primary font-bold">홍길동</a>
                            </td>
                            <td th:text="${appt.doctorName}">김닥터</td>
                            <td>
                                <span class="badge badge-blue" th:text="${appt.statusDescription}">예약 됨</span>
                            </td>
                            <td>
                                <form th:if="${appt.status == 0}"
                                    th:action="@{/reservations/{id}/cancel(id=${appt.reservationNum})}" method="post"
                                    onsubmit="return confirm('정말 취소하시겠습니까?');">
                                    <button type="submit" class="btn btn-sm btn-danger">취소</button>
                                </form>
                                <span th:if="${appt.status == 2}" class="text-muted">(취소됨)</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <div th:replace="layout/footer :: footerFragment"></div>

</body>

</html>